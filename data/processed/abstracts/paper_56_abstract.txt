microgrid key enabling solution future smart grid integrating distributed renewable generator stor age system efﬁciently serve local demand however due random intermittent characteristic renewable energy new challenge arise reliable operation microgrids address issue study paper real time energy management single microgrid system constitutes renewable generation system energy storage system aggregated load model renewable energy offset load time termed net energy proﬁle practically predictable ﬁnite error arbitrarily dis tributed aim minimize total energy cost modeled sum time varying strictly convex function conven tional energy drawn main grid ﬁnite horizon jointly optimizing energy charged discharged storage system time subject practical load storage constraint solve problem real time propose new line optimization approach devise online algorithm approach ﬁrst assume net energy proﬁle perfectly predicted known ahead time derive optimal line energy scheduling solution closed form next inspired optimal line solution propose sliding window based online algorithm real time energy management practical setup noisy predicted net energy proﬁle arbitrary error finally conduct simula tions based real wind generation data ireland power system evaluate performance proposed algorithm compared heuristically designed algorithm well conventional dynamic programming based solution